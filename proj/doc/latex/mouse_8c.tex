\doxysection{C\+:/\+Users/igorc/lcom/g2/proj/src/lib/drivers/\+KBC/mouse.c File Reference}
\hypertarget{mouse_8c}{}\label{mouse_8c}\index{C:/Users/igorc/lcom/g2/proj/src/lib/drivers/KBC/mouse.c@{C:/Users/igorc/lcom/g2/proj/src/lib/drivers/KBC/mouse.c}}
{\ttfamily \#include $<$lcom/lcf.\+h$>$}\newline
{\ttfamily \#include $<$lcom/utils.\+h$>$}\newline
{\ttfamily \#include \"{}mouse.\+h\"{}}\newline
{\ttfamily \#include \"{}i8042.\+h\"{}}\newline
{\ttfamily \#include \"{}KBC.\+h\"{}}\newline
Include dependency graph for mouse.\+c\+:
% FIG 0
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int() \mbox{\hyperlink{mouse_8c_a08895a8a691590216c1e72bbf1b2d333}{mouse\+\_\+subscribe\+\_\+int}} ()
\begin{DoxyCompactList}\small\item\em Subscribes mouse interrupts. \end{DoxyCompactList}\item 
int() \mbox{\hyperlink{mouse_8c_a3ecf823d80520009ae5e0d76ae40a3c3}{mouse\+\_\+unsubscribe\+\_\+int}} ()
\begin{DoxyCompactList}\small\item\em Unsubscribes mouse interrupts. \end{DoxyCompactList}\item 
int() \mbox{\hyperlink{mouse_8c_a3f71cbe6a40c250b92b67faa3e2e2302}{mouse\+\_\+int\+\_\+h}} ()
\begin{DoxyCompactList}\small\item\em Mouse interrupt handler. \end{DoxyCompactList}\item 
void() \mbox{\hyperlink{mouse_8c_a1538254b8ccba2f68e02cc3d5547722c}{mouse\+\_\+sync\+\_\+bytes}} ()
\begin{DoxyCompactList}\small\item\em Processes mouse synchronization bytes. \end{DoxyCompactList}\item 
void() \mbox{\hyperlink{mouse_8c_a2e235868a79d1a554279c352e8a19f59}{mouse\+\_\+bytes\+\_\+to\+\_\+packet}} ()
\begin{DoxyCompactList}\small\item\em Converts mouse bytes to a mouse packet. \end{DoxyCompactList}\item 
int() \mbox{\hyperlink{mouse_8c_a1703c3c5b61eef30d724b15cafd1d75e}{mouse\+\_\+write}} (uint8\+\_\+t command)
\begin{DoxyCompactList}\small\item\em Writes a command to the mouse. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{mouse_8c_ab482ddfd071decfbdf89450a12e535b9}{hook\+Id\+Mouse}} = 2
\item 
uint8\+\_\+t \mbox{\hyperlink{mouse_8c_af4b0411f5ba8899391c182a4371ad4fc}{byte\+Index}} = 0
\item 
uint8\+\_\+t \mbox{\hyperlink{mouse_8c_a22259d9fbf697c6e0d093fcf4a49da75}{mouse\+Bytes}} \mbox{[}3\mbox{]}
\item 
uint8\+\_\+t \mbox{\hyperlink{mouse_8c_a5c8d722c5804ead6dcf86ba3fe3d29c9}{current\+Byte}}
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\Hypertarget{mouse_8c_a2e235868a79d1a554279c352e8a19f59}\label{mouse_8c_a2e235868a79d1a554279c352e8a19f59} 
\index{mouse.c@{mouse.c}!mouse\_bytes\_to\_packet@{mouse\_bytes\_to\_packet}}
\index{mouse\_bytes\_to\_packet@{mouse\_bytes\_to\_packet}!mouse.c@{mouse.c}}
\doxysubsubsection{\texorpdfstring{mouse\_bytes\_to\_packet()}{mouse\_bytes\_to\_packet()}}
{\footnotesize\ttfamily void() mouse\+\_\+bytes\+\_\+to\+\_\+packet (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Converts mouse bytes to a mouse packet. 

This function converts the mouse bytes stored in the {\ttfamily mouse\+Bytes} array into a mouse packet. It assigns the corresponding bytes from {\ttfamily mouse\+Bytes} to the {\ttfamily mouse\+Packet} structure\textquotesingle{}s {\ttfamily bytes} array. Additionally, it extracts specific bits from the first byte of {\ttfamily mouse\+Bytes} and assigns them to the relevant fields of {\ttfamily mouse\+Packet} for button status, overflow flags, and delta values for the x and y axes. \Hypertarget{mouse_8c_a3f71cbe6a40c250b92b67faa3e2e2302}\label{mouse_8c_a3f71cbe6a40c250b92b67faa3e2e2302} 
\index{mouse.c@{mouse.c}!mouse\_int\_h@{mouse\_int\_h}}
\index{mouse\_int\_h@{mouse\_int\_h}!mouse.c@{mouse.c}}
\doxysubsubsection{\texorpdfstring{mouse\_int\_h()}{mouse\_int\_h()}}
{\footnotesize\ttfamily int() mouse\+\_\+int\+\_\+h (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Mouse interrupt handler. 

This function is the interrupt handler for the mouse. It reads the byte from the mouse and performs the necessary actions based on the received data. If a complete packet is received, it converts the bytes to a mouse packet structure.

\begin{DoxyReturn}{Returns}
0 if the byte was read successfully but a complete packet is not yet received, 1 if a complete packet is received and processed successfully, or an error code indicating the failure. 
\end{DoxyReturn}
\Hypertarget{mouse_8c_a08895a8a691590216c1e72bbf1b2d333}\label{mouse_8c_a08895a8a691590216c1e72bbf1b2d333} 
\index{mouse.c@{mouse.c}!mouse\_subscribe\_int@{mouse\_subscribe\_int}}
\index{mouse\_subscribe\_int@{mouse\_subscribe\_int}!mouse.c@{mouse.c}}
\doxysubsubsection{\texorpdfstring{mouse\_subscribe\_int()}{mouse\_subscribe\_int()}}
{\footnotesize\ttfamily int() mouse\+\_\+subscribe\+\_\+int (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Subscribes mouse interrupts. 

This function subscribes to mouse interrupts by setting the IRQ policy for the mouse interrupt line. The function sets the irq\+Set\+Mouse flag to indicate that the mouse interrupt is subscribed. The IRQ policy is set to re-\/enable the interrupts and exclusive. The hook ID is updated with the assigned value by the system.

\begin{DoxyReturn}{Returns}
Non-\/zero if error occured. 
\end{DoxyReturn}
\Hypertarget{mouse_8c_a1538254b8ccba2f68e02cc3d5547722c}\label{mouse_8c_a1538254b8ccba2f68e02cc3d5547722c} 
\index{mouse.c@{mouse.c}!mouse\_sync\_bytes@{mouse\_sync\_bytes}}
\index{mouse\_sync\_bytes@{mouse\_sync\_bytes}!mouse.c@{mouse.c}}
\doxysubsubsection{\texorpdfstring{mouse\_sync\_bytes()}{mouse\_sync\_bytes()}}
{\footnotesize\ttfamily void() mouse\+\_\+sync\+\_\+bytes (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Processes mouse synchronization bytes. 

This function processes mouse synchronization bytes received from the mouse controller. It checks the byte index and the value of the current byte to determine whether it is the first byte or a subsequent byte. If it is the first byte, it is stored in the mouse\+Bytes array at index 0. If it is a subsequent byte, it is stored in the {\ttfamily mouse\+Bytes} array at the current byte index. The byte index is incremented accordingly. \Hypertarget{mouse_8c_a3ecf823d80520009ae5e0d76ae40a3c3}\label{mouse_8c_a3ecf823d80520009ae5e0d76ae40a3c3} 
\index{mouse.c@{mouse.c}!mouse\_unsubscribe\_int@{mouse\_unsubscribe\_int}}
\index{mouse\_unsubscribe\_int@{mouse\_unsubscribe\_int}!mouse.c@{mouse.c}}
\doxysubsubsection{\texorpdfstring{mouse\_unsubscribe\_int()}{mouse\_unsubscribe\_int()}}
{\footnotesize\ttfamily int() mouse\+\_\+unsubscribe\+\_\+int (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Unsubscribes mouse interrupts. 

This function unsubscribes mouse interrupts by removing the IRQ policy of the mouse interrupt line. The function retrieves the hook ID associated with the mouse interrupt and passes it to sys\+\_\+irqrmpolicy to remove the policy. \begin{DoxyReturn}{Returns}
Non-\/zero if error occured. 
\end{DoxyReturn}
\Hypertarget{mouse_8c_a1703c3c5b61eef30d724b15cafd1d75e}\label{mouse_8c_a1703c3c5b61eef30d724b15cafd1d75e} 
\index{mouse.c@{mouse.c}!mouse\_write@{mouse\_write}}
\index{mouse\_write@{mouse\_write}!mouse.c@{mouse.c}}
\doxysubsubsection{\texorpdfstring{mouse\_write()}{mouse\_write()}}
{\footnotesize\ttfamily int() mouse\+\_\+write (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{command }\end{DoxyParamCaption})}



Writes a command to the mouse. 

This function writes a command to the mouse by sending the command byte to the Keyboard Controller. It waits for the mouse response and checks if the response is an acknowledgement (ACK). The function retries the write operation a maximum number of attempts if the acknowledgement is not received.


\begin{DoxyParams}{Parameters}
{\em command} & The command byte to be sent to the mouse. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if the command was written and acknowledged successfully, or 1 if an error occurred during the write operation. 
\end{DoxyReturn}


\doxysubsection{Variable Documentation}
\Hypertarget{mouse_8c_af4b0411f5ba8899391c182a4371ad4fc}\label{mouse_8c_af4b0411f5ba8899391c182a4371ad4fc} 
\index{mouse.c@{mouse.c}!byteIndex@{byteIndex}}
\index{byteIndex@{byteIndex}!mouse.c@{mouse.c}}
\doxysubsubsection{\texorpdfstring{byteIndex}{byteIndex}}
{\footnotesize\ttfamily uint8\+\_\+t byte\+Index = 0}

\Hypertarget{mouse_8c_a5c8d722c5804ead6dcf86ba3fe3d29c9}\label{mouse_8c_a5c8d722c5804ead6dcf86ba3fe3d29c9} 
\index{mouse.c@{mouse.c}!currentByte@{currentByte}}
\index{currentByte@{currentByte}!mouse.c@{mouse.c}}
\doxysubsubsection{\texorpdfstring{currentByte}{currentByte}}
{\footnotesize\ttfamily uint8\+\_\+t current\+Byte}

\Hypertarget{mouse_8c_ab482ddfd071decfbdf89450a12e535b9}\label{mouse_8c_ab482ddfd071decfbdf89450a12e535b9} 
\index{mouse.c@{mouse.c}!hookIdMouse@{hookIdMouse}}
\index{hookIdMouse@{hookIdMouse}!mouse.c@{mouse.c}}
\doxysubsubsection{\texorpdfstring{hookIdMouse}{hookIdMouse}}
{\footnotesize\ttfamily int hook\+Id\+Mouse = 2}

\Hypertarget{mouse_8c_a22259d9fbf697c6e0d093fcf4a49da75}\label{mouse_8c_a22259d9fbf697c6e0d093fcf4a49da75} 
\index{mouse.c@{mouse.c}!mouseBytes@{mouseBytes}}
\index{mouseBytes@{mouseBytes}!mouse.c@{mouse.c}}
\doxysubsubsection{\texorpdfstring{mouseBytes}{mouseBytes}}
{\footnotesize\ttfamily uint8\+\_\+t mouse\+Bytes\mbox{[}3\mbox{]}}

